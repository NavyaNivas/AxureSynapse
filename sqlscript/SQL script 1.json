{
	"name": "SQL script 1",
	"properties": {
		"content": {
			"query": "--create database\ncreate DATABASE demoDb\nGO\n\n--Use this database as primary..by default master will be there\nuse demoDb\nGo\n\n\n--Create master key encryption usinh scoped credential\ncreate MASTER KEY ENCRYPTION BY PASSWORD = 'Password@123'\nGO\n\nCREATE DATABASE SCOPED CREDENTIAL myCredential\nWITH IDENTITY = 'SHARED ACCESS SIGNATURE',\nsecret = 'sv=2024-11-04&ss=bfqt&srt=sco&sp=rwdlacupyx&se=2025-11-12T13:27:07Z&st=2025-11-12T05:12:07Z&spr=https&sig=KjgW6LT6xScki5vkSDzzNOlP7lmWseXP37TLrjHG%2B9I%3D'\n--this secret key can be found inside storage account in shared access signature-genaerate sas token--\nGO\n\n\n--create external datasource\ncreate EXTERNAL DATA SOURCE  myDataSource with(\n\n    LOCATION = 'https://synapsestorage1505.blob.core.windows.net/',   --location can be found in accountstorage level-settings-primaryendpoint--\n    CREDENTIAL = myCredential\n)\nGO\n\n\n--create extrenal file format\nCREATE EXTERNAL FILE FORMAT parquetFileFormat WITH(\n    FORMAT_TYPE = PARQUET,\n    DATA_COMPRESSION = 'org.apache.hadoop.io.compress.SnappyCodec'\n)\nGO\n\n\n--create schema\ncreate SCHEMA NYCTaxi\nGO\n\n\n--create external table inside the schema(cetas)\nCREATE EXTERNAL TABLE NYCTaxi.passengerDetails WITH(\n    LOCATION = 'synapsecontainer/NYCTaxi/DATA',               --location inside the synapse container--\n    DATA_SOURCE = myDataSource,\n    FILE_FORMAT = parquetFileFormat\n)\nAS\nSELECT TOP 100 * FROM\nOPENROWSET(\n\n    BULK 'https://synapsestorage1505.dfs.core.windows.net/synapsecontainer/Data/NYCTripSmall.parquet',\n    FORMAT = 'parquet'\n) \nAS[result]\nGO\n\n--to check the data in the extrenal db\nselect * from NYCTaxi.passengerDetails\n\n--can also do this by reading the parquet file in the extrnal datasource location..\nSELECT TOP 100 * FROM\nOPENROWSET(\n\n    BULK 'https://synapsestorage1505.dfs.core.windows.net/synapsecontainer/NYCTaxi/DATA/AC33B604-2030-4E4C-ACB8-3F4E5256968F_2_0-1.parquet',\n    FORMAT = 'parquet'\n) \nAS[result]\n\n\n\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "demoDb",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}